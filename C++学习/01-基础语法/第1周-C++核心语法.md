# 第1周：C++核心语法

## 学习目标

掌握C++基本语法和特性，包括现代C++特性、变量类型、控制流、函数和类的基础知识。

## 学习内容

### 1. C++11/14/17/20新特性

#### 1.1 auto关键字
```cpp
// C++11之前
std::vector<int>::iterator it = vec.begin();

// C++11之后
auto it = vec.begin();
auto x = 42;        // int
auto y = 3.14;      // double
auto z = "hello";   // const char*
```

#### 1.2 范围for循环
```cpp
std::vector<int> vec = {1, 2, 3, 4, 5};

// 传统for循环
for (int i = 0; i < vec.size(); ++i) {
    std::cout << vec[i] << " ";
}

// 范围for循环
for (const auto& item : vec) {
    std::cout << item << " ";
}
```

#### 1.3 初始化列表
```cpp
// C++11统一初始化语法
std::vector<int> vec{1, 2, 3, 4, 5};
std::map<std::string, int> m{{"apple", 1}, {"banana", 2}};

// 类成员初始化
class MyClass {
private:
    int x{10};
    std::string name{"default"};
public:
    MyClass() = default;
};
```

#### 1.4 lambda表达式
```cpp
std::vector<int> vec = {1, 2, 3, 4, 5};

// 基本lambda
auto square = [](int x) { return x * x; };
std::cout << square(5) << std::endl;  // 输出: 25

// 捕获变量
int multiplier = 2;
auto multiply = [multiplier](int x) { return x * multiplier; };

// 使用lambda与STL算法
std::transform(vec.begin(), vec.end(), vec.begin(), 
               [](int x) { return x * x; });
```

#### 1.5 nullptr
```cpp
// C++11之前
int* ptr = NULL;

// C++11之后
int* ptr = nullptr;

// 类型安全
void func(int x);
void func(char* ptr);

func(nullptr);  // 调用func(char* ptr)
```

### 2. 变量和数据类型

#### 2.1 基本数据类型
```cpp
// 整数类型
int a = 42;
long b = 1000000L;
long long c = 10000000000LL;

// 浮点类型
float f = 3.14f;
double d = 3.14159;
long double ld = 3.14159265359L;

// 字符类型
char ch = 'A';
wchar_t wch = L'中';
char16_t c16 = u'字';
char32_t c32 = U'符';

// 布尔类型
bool flag = true;
bool result = (a > 0);
```

#### 2.2 类型推导
```cpp
// decltype关键字
int x = 42;
decltype(x) y = x;  // y的类型是int

// decltype(auto)
std::vector<int> vec = {1, 2, 3};
decltype(auto) first = vec[0];  // 推导为int&

// 函数返回类型推导
auto add(int a, int b) -> decltype(a + b) {
    return a + b;
}
```

#### 2.3 const和constexpr
```cpp
// const变量
const int MAX_SIZE = 100;
const std::string APP_NAME = "MyApp";

// constexpr编译时常量
constexpr int factorial(int n) {
    return (n <= 1) ? 1 : n * factorial(n - 1);
}
constexpr int fact_5 = factorial(5);  // 编译时计算

// constexpr变量
constexpr double pi = 3.14159265359;
```

### 3. 控制流语句

#### 3.1 条件语句
```cpp
// if-else语句
int score = 85;
if (score >= 90) {
    std::cout << "优秀" << std::endl;
} else if (score >= 80) {
    std::cout << "良好" << std::endl;
} else if (score >= 70) {
    std::cout << "中等" << std::endl;
} else {
    std::cout << "需要努力" << std::endl;
}

// 三元运算符
std::string grade = (score >= 60) ? "及格" : "不及格";

// switch语句
char operation = '+';
switch (operation) {
    case '+':
        std::cout << "加法运算" << std::endl;
        break;
    case '-':
        std::cout << "减法运算" << std::endl;
        break;
    case '*':
        std::cout << "乘法运算" << std::endl;
        break;
    case '/':
        std::cout << "除法运算" << std::endl;
        break;
    default:
        std::cout << "未知运算" << std::endl;
        break;
}
```

#### 3.2 循环语句
```cpp
// for循环
for (int i = 0; i < 10; ++i) {
    std::cout << i << " ";
}

// while循环
int count = 0;
while (count < 5) {
    std::cout << "Count: " << count << std::endl;
    ++count;
}

// do-while循环
int input;
do {
    std::cout << "请输入一个正数: ";
    std::cin >> input;
} while (input <= 0);

// 嵌套循环
for (int i = 1; i <= 9; ++i) {
    for (int j = 1; j <= i; ++j) {
        std::cout << j << "x" << i << "=" << i*j << "\t";
    }
    std::cout << std::endl;
}
```

#### 3.3 跳转语句
```cpp
// break语句
for (int i = 0; i < 10; ++i) {
    if (i == 5) {
        break;  // 跳出循环
    }
    std::cout << i << " ";
}

// continue语句
for (int i = 0; i < 10; ++i) {
    if (i % 2 == 0) {
        continue;  // 跳过本次循环
    }
    std::cout << i << " ";  // 只输出奇数
}

// goto语句（不推荐使用）
int x = 0;
label:
    std::cout << x << " ";
    x++;
    if (x < 5) goto label;
```

### 4. 函数定义和调用

#### 4.1 函数声明和定义
```cpp
// 函数声明
int add(int a, int b);
double calculateCircleArea(double radius);

// 函数定义
int add(int a, int b) {
    return a + b;
}

double calculateCircleArea(double radius) {
    constexpr double pi = 3.14159265359;
    return pi * radius * radius;
}
```

#### 4.2 函数重载
```cpp
// 函数重载
int multiply(int a, int b) {
    return a * b;
}

double multiply(double a, double b) {
    return a * b;
}

int multiply(int a, int b, int c) {
    return a * b * c;
}

// 使用
std::cout << multiply(3, 4) << std::endl;        // 调用int版本
std::cout << multiply(3.5, 2.1) << std::endl;    // 调用double版本
std::cout << multiply(2, 3, 4) << std::endl;     // 调用三参数版本
```

#### 4.3 默认参数
```cpp
// 默认参数
void printMessage(const std::string& message, 
                  const std::string& prefix = "INFO",
                  bool newLine = true) {
    std::cout << "[" << prefix << "] " << message;
    if (newLine) {
        std::cout << std::endl;
    }
}

// 使用
printMessage("Hello World");
printMessage("Error occurred", "ERROR");
printMessage("Debug info", "DEBUG", false);
```

#### 4.4 引用和指针参数
```cpp
// 值传递
void swapByValue(int a, int b) {
    int temp = a;
    a = b;
    b = temp;
}

// 引用传递
void swapByReference(int& a, int& b) {
    int temp = a;
    a = b;
    b = temp;
}

// 指针传递
void swapByPointer(int* a, int* b) {
    int temp = *a;
    *a = *b;
    *b = temp;
}

// 使用示例
int x = 10, y = 20;
swapByValue(x, y);      // x, y不变
swapByReference(x, y);  // x, y交换
swapByPointer(&x, &y);  // x, y再次交换
```

### 5. 类和对象基础

#### 5.1 类的定义
```cpp
class Rectangle {
private:
    double width;
    double height;

public:
    // 构造函数
    Rectangle() : width(0), height(0) {}
    Rectangle(double w, double h) : width(w), height(h) {}
    
    // 析构函数
    ~Rectangle() {
        std::cout << "Rectangle destroyed" << std::endl;
    }
    
    // 成员函数
    double getArea() const {
        return width * height;
    }
    
    double getPerimeter() const {
        return 2 * (width + height);
    }
    
    void setDimensions(double w, double h) {
        width = w;
        height = h;
    }
    
    // 访问器函数
    double getWidth() const { return width; }
    double getHeight() const { return height; }
    void setWidth(double w) { width = w; }
    void setHeight(double h) { height = h; }
};
```

#### 5.2 对象创建和使用
```cpp
int main() {
    // 创建对象
    Rectangle rect1;                    // 默认构造函数
    Rectangle rect2(5.0, 3.0);          // 参数化构造函数
    
    // 使用对象
    std::cout << "Rectangle 1 area: " << rect1.getArea() << std::endl;
    std::cout << "Rectangle 2 area: " << rect2.getArea() << std::endl;
    
    // 修改对象
    rect1.setDimensions(4.0, 6.0);
    std::cout << "Rectangle 1 new area: " << rect1.getArea() << std::endl;
    
    return 0;
}
```

#### 5.3 访问控制
```cpp
class BankAccount {
private:
    double balance;
    std::string accountNumber;
    
protected:
    std::string ownerName;
    
public:
    BankAccount(const std::string& number, const std::string& owner) 
        : accountNumber(number), ownerName(owner), balance(0.0) {}
    
    // 公共接口
    void deposit(double amount) {
        if (amount > 0) {
            balance += amount;
        }
    }
    
    bool withdraw(double amount) {
        if (amount > 0 && amount <= balance) {
            balance -= amount;
            return true;
        }
        return false;
    }
    
    double getBalance() const {
        return balance;
    }
    
    std::string getAccountNumber() const {
        return accountNumber;
    }
};
```

## 实践练习

### 练习1：基础语法练习
编写一个程序，实现以下功能：
1. 使用auto关键字声明变量
2. 使用范围for循环遍历数组
3. 使用lambda表达式计算平方
4. 使用constexpr计算阶乘

### 练习2：函数练习
编写一个计算器类，包含以下功能：
1. 基本四则运算函数
2. 函数重载支持不同数据类型
3. 默认参数设置
4. 使用引用传递提高效率

### 练习3：类设计练习
设计一个学生类，包含：
1. 私有成员：姓名、学号、成绩
2. 公有接口：设置信息、获取信息、计算平均分
3. 构造函数和析构函数
4. 适当的访问控制

## 每日学习任务

### 第1天：现代C++特性
- 学习auto关键字和类型推导
- 练习范围for循环
- 理解初始化列表语法

### 第2天：数据类型和变量
- 掌握基本数据类型
- 学习const和constexpr
- 理解类型推导机制

### 第3天：控制流语句
- 掌握if-else语句
- 学习循环语句
- 理解跳转语句

### 第4天：函数基础
- 学习函数声明和定义
- 掌握函数重载
- 理解参数传递方式

### 第5天：类和对象
- 学习类的基本概念
- 掌握构造函数和析构函数
- 理解访问控制

### 第6天：综合练习
- 完成所有实践练习
- 编写综合程序
- 复习本周内容

### 第7天：项目实践
- 开始项目1：简单容器类
- 应用本周所学知识
- 准备下周学习内容

## 检查点

### 第1周结束时的能力要求
- [ ] 能够使用auto关键字和类型推导
- [ ] 熟练使用范围for循环和lambda表达式
- [ ] 掌握基本数据类型和const/constexpr
- [ ] 能够编写if-else和循环语句
- [ ] 能够定义和调用函数
- [ ] 理解函数重载和默认参数
- [ ] 能够定义简单的类
- [ ] 理解构造函数、析构函数和访问控制
- [ ] 完成项目1的基础部分

## 常见问题解答

### Q: 什么时候使用auto关键字？
A: 当类型明显或复杂时使用auto，但要确保代码可读性。避免过度使用导致代码难以理解。

### Q: lambda表达式如何捕获变量？
A: 
- `[]`：不捕获任何变量
- `[=]`：按值捕获所有变量
- `[&]`：编译引用捕获所有变量
- `[x]`：按值捕获x
- `[&x]`：按引用捕获x

### Q: const和constexpr的区别？
A: const表示运行时常量，constexpr表示编译时常量。constexpr可以在编译时计算，提高性能。

### Q: 如何选择值传递、引用传递还是指针传递？
A: 
- 值传递：小对象，不需要修改原对象
- 引用传递：需要修改原对象，避免拷贝开销
- 指针传递：可能为nullptr，需要明确表示

---

**学习时间**：第1周  
**预计完成时间**：2024-01-22
